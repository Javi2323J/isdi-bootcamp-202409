<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unsocial</title>

    <link rel="shortcut icon" href="https://b00tc4mp.com/favicon.ico" type="image/x-icon">

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Sixtyfour&display=swap');

        :root {
            --color: #00FE00;
            --font: 'Sixtyfour';
            font-family: var(--font);
        }

        body {
            display: flex;
            flex-direction: column;
            text-align: center;
            justify-content: center;
            align-items: center;
            justify-content: center;
            background-color: black;
            color: var(--color);
        }

        section,
        form {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        input {
            color: var(--color);
            background-color: inherit;
            font-family: inherit;
            margin-top: 10px;
            margin-bottom: 20px;
        }

        a:visited {
            color: var(--color);
        }

        h1 {
            margin-bottom: 10px;
        }

        h2 {
            margin-bottom: 30px;
        }

        a {
            margin-top: 20px;
        }

        label,
        input,
        button {
            display: block;
        }

        button {
            background-color: black;
            color: var(--color);
            font-family: var(--font);
            padding: 5px;
            border-bottom: 1px solid #545454;
            border-right: 1px solid #545454
        }

        #up {
            margin-top: 50px;
            margin-bottom: 10px;
        }
    </style>
</head>

<body>
    <h1>Unsocial</h1>

    <script> // SCRIPT START
        var users = [ // La "base de datos" con los usuarios
            { name: 'Peter Pan', email: 'peter@pan.com', username: 'peterpan', password: '123' },
            { name: 'Wendy Darling', email: 'wendy@darling.com', username: 'wendydarling', password: '123' }
        ]

        var loggedInUser = null // Variable para reconocer al usuario conectado

        var clicks = 0

        var loginSection = document.createElement('section') // Creación de la sección login y sus elementos

        var loginTitle = document.createElement('h2') // Título Login
        loginTitle.innerText = 'Login'
        loginSection.appendChild(loginTitle)

        var loginForm = document.createElement('form') // El formulario del login
        loginSection.appendChild(loginForm)

        var loginUsernameLabel = document.createElement('label') // El texto "Username"
        loginUsernameLabel.htmlFor = 'username'
        loginUsernameLabel.innerText = 'Username'
        loginForm.appendChild(loginUsernameLabel)

        var loginUsernameInput = document.createElement('input') // El input de username
        loginUsernameInput.type = 'text'
        loginUsernameInput.id = 'username'
        loginForm.appendChild(loginUsernameInput)

        var loginPasswordLabel = document.createElement('label') // El texto "password"
        loginPasswordLabel.htmlFor = 'password'
        loginPasswordLabel.innerText = 'Password'
        loginForm.appendChild(loginPasswordLabel)

        var loginPasswordInput = document.createElement('input') // El input de password
        loginPasswordInput.type = "password"
        loginPasswordInput.id = "password"
        loginForm.appendChild(loginPasswordInput)

        var loginSubmitButton = document.createElement('button') // El botón de login
        loginSubmitButton.type = 'submit'
        loginSubmitButton.innerText = 'Login'
        loginForm.appendChild(loginSubmitButton)

        loginSubmitButton.addEventListener('click', function (event) { // Botón login (borramos login y montamos home)
            event.preventDefault()

            loggedInUser = users.find(function (user) { // Miramos si el usuario es válido
                var username = loginUsernameInput.value
                var password = loginPasswordInput.value
                return user.username === username && user.password === password
            })
            if (!loggedInUser) { // CASE el usuario no es válido
                alert('cagaste')
                loginPasswordInput.value = ''
            } else { // CASE el usuario sí és valido
                loginSection.remove() // Borramos el login

                loginForm.reset() // Borramos el form del login (porque salimos de login)

                var homeSection = document.createElement('section') // Creación Home

                var homeTitle = document.createElement('h2') // Título de home
                homeTitle.innerText = "Home"
                homeSection.appendChild(homeTitle)

                var homeWelcome = document.createElement('h3') // Texto de bienvenida
                homeWelcome.innerHTML = "Welcome, " + loggedInUser.name + "!"
                homeSection.appendChild(homeWelcome)

                var logoutButton = document.createElement('button') // Botón de logout
                logoutButton.type = "button"
                logoutButton.innerText = "Logout"
                homeSection.appendChild(logoutButton)

                logoutButton.addEventListener("click", function (event) { // Acción del botón de logout (dentro de home)
                    event.preventDefault()

                    loggedInUser = null // Desconectamos al usuario

                    homeSection.remove() // Desmontamos home

                    body.appendChild(loginSection) // Volvemos al login
                })

                // PARTE DE EJERCICIO DE CLICKS

                var sumButton = document.createElement('button') // (Todavía dentro de home) Botón de sumar
                sumButton.type = "button"
                sumButton.innerText = "Sum"
                homeSection.appendChild(sumButton)

                var minButton = document.createElement('button') // Botón de restar
                minButton.type = "button"
                minButton.innerText = "Min"
                homeSection.appendChild(minButton)

                var clicksSum = document.createElement('p') // Parágrafo donde saldrá el texto con el número de clicks
                clicksSum.innerText = clicks
                homeSection.appendChild(clicksSum)

                sumButton.addEventListener('click', function () { // Acción del botón sumar
                    clicks++
                    clicksSum.innerText = clicks
                })
                minButton.addEventListener('click', function () { // Acción del botón restar
                    if (clicks < 1) { // No podemos bajar de 0
                        alert('Can\'t go lower')
                        return
                    } else {
                        clicks--
                        clicksSum.innerText = clicks
                    }
                })

                // PARTE DEL EJERCICIO DE CLICKS
            }
            body.appendChild(homeSection) // Montamos home
        })

        var loginRegisterLink = document.createElement('a') // (Dentro del login) Link a la pantalla de registro
        loginRegisterLink.href = ''
        loginRegisterLink.innerText = 'Register'
        loginSection.appendChild(loginRegisterLink)

        loginRegisterLink.addEventListener('click', function (event) { // Borramos login y vamos a la pantalla de registro
            event.preventDefault()

            loginSection.remove() // Desmontamos login

            loginForm.reset() // Borramos el contenido que hubiese escrito en el formulario del login

            var registerSection = document.createElement('section') // Creación de todos los elemenos en la pantalla de registro

            var registerTitle = document.createElement('h2') // Título de registro
            registerTitle.innerText = "Register"
            registerSection.appendChild(registerTitle)

            var registerForm = document.createElement('form') // Creación del formulario que tendrá los campos para el registro
            registerSection.appendChild(registerForm)

            var registerNameLabel = document.createElement('label') // Texto de Name
            registerNameLabel.htmlFor = 'name'
            registerNameLabel.innerText = "Name"
            registerForm.appendChild(registerNameLabel)

            var registerNameInput = document.createElement('input') // Input de Name
            registerNameInput.type = "text"
            registerNameInput.id = "name"
            registerForm.appendChild(registerNameInput)

            var registerEmailLabel = document.createElement('label') // Texto de Email
            registerEmailLabel.htmlFor = "email"
            registerEmailLabel.innerText = "E-mail"
            registerForm.appendChild(registerEmailLabel)

            var registerEmailInput = document.createElement('input') // Input de email
            registerEmailInput.type = "email"
            registerEmailInput.id = "email"
            registerForm.appendChild(registerEmailInput)

            var registerUsernameLabel = document.createElement('label') // Texto de username
            registerUsernameLabel.htmlFor = "username"
            registerUsernameLabel.innerText = "Username"
            registerForm.appendChild(registerUsernameLabel)

            var registerUsernameInput = document.createElement('input') // Input de username
            registerUsernameInput.type = "text"
            registerUsernameInput.id = "username"
            registerForm.appendChild(registerUsernameInput)

            var registerPasswordLabel = document.createElement('label') // Texto de password
            registerPasswordLabel.htmlFor = "password"
            registerPasswordLabel.innerText = "Password"
            registerForm.appendChild(registerPasswordLabel)

            var registerPasswordInput = document.createElement('input') // Input de password
            registerPasswordInput.type = "password"
            registerPasswordInput.id = "password"
            registerForm.appendChild(registerPasswordInput)

            var registerConfirmPasswordLabel = document.createElement('label') // Texto de confirm password
            registerConfirmPasswordLabel.htmlFor = "confirmpassword"
            registerConfirmPasswordLabel.innerText = "Confirm Password"
            registerForm.appendChild(registerConfirmPasswordLabel)

            var registerConfirmPasswordInput = document.createElement('input') // Input de confirm password
            registerConfirmPasswordInput.type = "password"
            registerConfirmPasswordInput.id = "confirmpassword"
            registerForm.appendChild(registerConfirmPasswordInput)

            var registerSubmitButton = document.createElement('button') // Botón de registro
            registerSubmitButton.type = "submit"
            registerSubmitButton.innerText = "Register"
            registerForm.appendChild(registerSubmitButton)

            registerSubmitButton.addEventListener('click', function (event) { // Acción del botón para registrar al usuario y volver a la pantalla login
                event.preventDefault()
                if (registerEmailInput.value === '' || registerNameInput.value === '' || registerUsernameInput.value === '' || registerPasswordInput.value === '' || registerConfirmPasswordInput.value === '') {
                    alert('Campos incompletos')
                    return
                }

                if (!registerEmailInput.value.includes('@')) { // Comprobación de si el email tiene un arroba
                    alert('Missing \'@\' in email')
                    return
                }
                else if (!registerEmailInput.value.includes('.')) { // Commprobación de si el email tiene un punnto
                    alert('Missing \'.\' in email')
                    return
                }

                // Guardar todos los valores
                var name = registerNameInput.value
                var email = registerEmailInput.value
                var username = registerUsernameInput.value
                var password = registerPasswordInput.value
                var confirmpassword = registerConfirmPasswordInput.value

                var repeatedUsername = users.find(function (user) { return user.username === username }) // Variable para comprobar si el username ya existe
                var repeatedEmail = users.find(function (user) { return user.email === email }) // Variable para ver si el email ya está registrado

                if (repeatedEmail) { // Comprobar email
                    alert('This email already exists')
                    return
                }

                if (password != confirmpassword) { // Comprobar que confirm password tiene el mismo valor que password
                    alert('Incorrect password')
                    return
                }

                if (repeatedUsername) { // Comprobar username
                    alert('This username already exists, try another')
                    return
                }

                var user = { 'name': name, 'email': email, 'username': username, 'password': password } // Insertamos el usuario entero
                users.push(user)


                registerForm.reset() // Borramos el formulario de registro

                registerSection.remove() // "Salimos" de registro

                body.appendChild(loginSection) // Montamos el login
            })

            var registerLoginLink = document.createElement('a')
            registerLoginLink.href = ""
            registerLoginLink.innerText = "Login"
            registerSection.appendChild(registerLoginLink)

            registerLoginLink.addEventListener('click', function (event) { // Borramos registro y montamos login
                event.preventDefault()

                registerSection.remove() // "Salimos" de registro

                registerForm.reset() // Borramos el formulario de registro

                body.appendChild(loginSection) // Montamos el login
            })

            body.appendChild(registerSection)
        })

        var body = document.querySelector('body') // Variable donde almacenamos el body
        body.appendChild(loginSection) // El inicial, empezamos la página enseñando el login
    </script>
</body>

</html>